<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>锦曼商城（mpvue+WeUI+MySQL+Node.js） | 临渊羡鱼的个人技术博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.原生小程序开发有哪些痛点？(掌握)123456- 频繁调用setData及setData过程中页面跳闪- 强制将WXSS、WXML和JS代码分离到3个不同的文件中- 没有状态管理，参考Vuex和Redux- 没有过滤器- 不能使用 less、sass 等预编译器- 组件化支持能力太弱  2.为什么使用第三方框架？(理解)12345678- 只要熟悉vue或react即可快速上手,学习成本低 -">
<meta property="og:type" content="article">
<meta property="og:title" content="锦曼商城（mpvue+WeUI+MySQL+Node.js）">
<meta property="og:url" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/index.html">
<meta property="og:site_name" content="临渊羡鱼的个人技术博客">
<meta property="og:description" content="1.原生小程序开发有哪些痛点？(掌握)123456- 频繁调用setData及setData过程中页面跳闪- 强制将WXSS、WXML和JS代码分离到3个不同的文件中- 没有状态管理，参考Vuex和Redux- 没有过滤器- 不能使用 less、sass 等预编译器- 组件化支持能力太弱  2.为什么使用第三方框架？(理解)12345678- 只要熟悉vue或react即可快速上手,学习成本低 -">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1559442160866.png">
<meta property="og:image" content="http://img.dongcoder.com/up/info/201903/20190313100312653261.jpg">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/02.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/01.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/03.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/04.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/05.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/06.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/07.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106190827294-1199751417.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106190848122-865769222.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205127200-216760608.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205159528-291294353.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205332075-1346398687.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205642513-1610316669.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205730528-339953907.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205929419-463639658.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210027731-2046065048.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210117559-254939495.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210233528-2079516846.png">
<meta property="og:image" content="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210345513-1798455572.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190404174408525.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5MTA2ODU0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190408102625303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5MTA2ODU0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190103143547778.">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/08.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/09.png">
<meta property="og:image" content="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/10.png">
<meta property="article:published_time" content="2020-02-23T16:59:06.460Z">
<meta property="article:modified_time" content="2020-02-23T19:06:44.516Z">
<meta property="article:author" content="版权归侯仕平所有，并提供技术支持！未经授权，不得商用！">
<meta property="article:tag" content="技术博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1559442160866.png">
  
    <link rel="alternate" href="/atom.xml" title="临渊羡鱼的个人技术博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">临渊羡鱼的个人技术博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">仅供交流和学习用，勿商用！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">全部条目</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://harrison258.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-锦曼商城（mpvue+WeUI+MySQL+Node.js）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/" class="article-date">
  <time datetime="2020-02-23T16:59:06.460Z" itemprop="datePublished">2020-02-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      锦曼商城（mpvue+WeUI+MySQL+Node.js）
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-原生小程序开发有哪些痛点？-掌握"><a href="#1-原生小程序开发有哪些痛点？-掌握" class="headerlink" title="1.原生小程序开发有哪些痛点？(掌握)"></a>1.原生小程序开发有哪些痛点？(掌握)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- 频繁调用setData及setData过程中页面跳闪</span><br><span class="line">- 强制将WXSS、WXML和JS代码分离到3个不同的文件中</span><br><span class="line">- 没有状态管理，参考Vuex和Redux</span><br><span class="line">- 没有过滤器</span><br><span class="line">- 不能使用 less、sass 等预编译器</span><br><span class="line">- 组件化支持能力太弱</span><br></pre></td></tr></table></figure>

<h3 id="2-为什么使用第三方框架？-理解"><a href="#2-为什么使用第三方框架？-理解" class="headerlink" title="2.为什么使用第三方框架？(理解)"></a>2.为什么使用第三方框架？(理解)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- 只要熟悉vue或react即可快速上手,学习成本低 </span><br><span class="line">- 一套代码可在多端编译运行(微信,支付宝,h5,RN)  支付宝小程序暂不完善</span><br><span class="line">- 组件化开发，完美解决组件隔离，组件嵌套，组件通信等问题 </span><br><span class="line">- 支持使用第三方 npm 资源</span><br><span class="line">- 使小程序可支持 Promise，解决回调烦恼</span><br><span class="line">- 可使用 Generator Fu-nction &#x2F; Class &#x2F; Async Function 等特性，提升开发效率 </span><br><span class="line">- 对小程序本身的优化，如生命周期的补充，性能的优化等等</span><br><span class="line">- 支持样式编译器: sass&#x2F;Less，模板编译器，代码编译器：Babel&#x2F;Typescript</span><br></pre></td></tr></table></figure>

<h3 id="3-有哪些第三方框架？"><a href="#3-有哪些第三方框架？" class="headerlink" title="3.有哪些第三方框架？"></a>3.有哪些第三方框架？</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- wepy       腾讯</span><br><span class="line">- mpvue      美团</span><br><span class="line">- taro       京东</span><br><span class="line"></span><br><span class="line">各有各的生态圈，需要根据自己的开发目标和开发基础进行选择。</span><br></pre></td></tr></table></figure>

<h3 id="4-框架对比"><a href="#4-框架对比" class="headerlink" title="4.框架对比"></a>4.框架对比</h3><p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1559442160866.png" alt="1559442160866"></p>
<p>　　PostCSS:是一个用 JavaScript 工具和插件转换 CSS 代码的工具(<a href="https://www.postcss.com.cn/)。" target="_blank" rel="noopener">https://www.postcss.com.cn/)。</a></p>
<h3 id="5-使用mpvue开发小程序的优点-掌握"><a href="#5-使用mpvue开发小程序的优点-掌握" class="headerlink" title="5.使用mpvue开发小程序的优点(掌握)"></a>5.使用mpvue开发小程序的优点(掌握)</h3><p>　　mpvue中文文档网址：<a href="http://mpvue.com/mpvue/。" target="_blank" rel="noopener">http://mpvue.com/mpvue/。</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- 彻底的组件化开发能力：提高代码开发效率</span><br><span class="line">- 完整的 Vue.js 开发体验</span><br><span class="line">- 方便的 Vuex 数据管理方案：方便构建复杂应用</span><br><span class="line">- 快捷的 webpack 构建机制：自定义构建策略、开发阶段 hotReload</span><br><span class="line">- 支持使用 npm 外部依赖</span><br><span class="line">- 使用 Vue.js 命令行工具 vue-cli 快速初始化项目</span><br><span class="line">- H5 代码转换编译成小程序目标代码的能力</span><br></pre></td></tr></table></figure>

<p>　　mpvue是一个使用 Vue.js 开发小程序的前端框架。框架基于 Vue.js 核心，框架整体和vue语法保持一致，整体开发体验良好。</p>
<h3 id="6-Vue生命周期钩子函数-必须掌握"><a href="#6-Vue生命周期钩子函数-必须掌握" class="headerlink" title="6.Vue生命周期钩子函数(必须掌握)"></a>6.Vue生命周期钩子函数(必须掌握)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">01）beforeCreate：在实例初始化之后，数据观测 (data observer) 和 event&#x2F;watcher 事件配置之前被调用。</span><br><span class="line"></span><br><span class="line">02）created：在实例创建完成后被立即调用。在这一步，实例已完成以下的配置：数据观测 (data observer)，属性和方法的运算，watch&#x2F;event 事件回调。然而，挂载阶段还没开始，$el 属性目前不可见。</span><br><span class="line"></span><br><span class="line">03）beforeMount：在挂载开始之前被调用：相关的 render 函数首次被调用。</span><br><span class="line"></span><br><span class="line">04）mounted：el 被新创建的 vm.$el 替换，并挂载到实例上去之后调用该钩子。如果 root 实例挂载了一个文档内元素，当 mounted 被调用时 vm.$el 也在文档内。</span><br><span class="line">	注意 mounted 不会承诺所有的子组件也都一起被挂载。如果你希望等到整个视图都渲染完毕，可以用 vm.$nextTick 替换掉 mounted：</span><br><span class="line">    mounted: function () &#123;</span><br><span class="line">      this.$nextTick(function () &#123;</span><br><span class="line">        &#x2F;&#x2F; Code that will run only after the</span><br><span class="line">        &#x2F;&#x2F; entire view has been rendered</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">05）beforeUpdate：数据更新时调用，发生在虚拟 DOM 打补丁之前。这里适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器。</span><br><span class="line"></span><br><span class="line">06）updated：当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态。如果要相应状态改变，通常最好使用计算属性或 watcher 取而代之。</span><br><span class="line"></span><br><span class="line">07）activated：keep-alive 组件激活时调用。</span><br><span class="line"></span><br><span class="line">08）deactivated：keep-alive 组件停用时调用。</span><br><span class="line"></span><br><span class="line">09）beforeDestroy：实例销毁之前调用，实例仍然完全可用。</span><br><span class="line"></span><br><span class="line">10）destroyed：Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。</span><br></pre></td></tr></table></figure>

<p><img src="http://img.dongcoder.com/up/info/201903/20190313100312653261.jpg" alt=""></p>
<h3 id="7-微信小程序生命周期钩子函数-必须掌握"><a href="#7-微信小程序生命周期钩子函数-必须掌握" class="headerlink" title="7.微信小程序生命周期钩子函数(必须掌握)"></a>7.微信小程序生命周期钩子函数(必须掌握)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; app 部分：</span><br><span class="line">onLaunch，初始化</span><br><span class="line">onShow，当小程序启动，或从后台进入前台显示</span><br><span class="line">onHide，当小程序从前台进入后台</span><br><span class="line"></span><br><span class="line">&gt; page 部分：</span><br><span class="line">onLoad，监听页面加载</span><br><span class="line">onShow，监听页面显示</span><br><span class="line">onReady，监听页面初次渲染完成</span><br><span class="line">onHide，监听页面隐藏</span><br><span class="line">onUnload，监听页面卸载</span><br><span class="line">onPullDownRefresh，监听用户下拉动作</span><br><span class="line">onReachBottom，页面上拉触底事件的处理函数</span><br><span class="line">onShareAppMessage，用户点击右上角分享</span><br><span class="line">onPageScroll，页面滚动</span><br><span class="line">onTabItemTap, 当前是 tab 页时，点击 tab 时触发</span><br></pre></td></tr></table></figure>

<p>　　<strong>注：</strong>微信小程序没在DOM和BOM操作。</p>
<h3 id="8-搭建mpvue小程序开发环境"><a href="#8-搭建mpvue小程序开发环境" class="headerlink" title="8.搭建mpvue小程序开发环境"></a>8.搭建mpvue小程序开发环境</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">1）安装node.js</span><br><span class="line">	node --version</span><br><span class="line">2）npm改为国内淘宝镜像</span><br><span class="line">	npm set registry https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;</span><br><span class="line">3）安装vue-cli</span><br><span class="line">	npm install vue-cli -g</span><br><span class="line">4）安装微信开发者工具</span><br><span class="line">	https:&#x2F;&#x2F;developers.weixin.qq.com&#x2F;miniprogram&#x2F;dev&#x2F;devtools&#x2F;download.html</span><br><span class="line">5）安装IDE(也可以用sublime):</span><br><span class="line">	https:&#x2F;&#x2F;code.visualstudio.com</span><br><span class="line">	安装完vscode后，在它的插件管理器中，查找Vetur并安装，然后重启一下vscode后，插件即生效。</span><br><span class="line">	</span><br><span class="line">注意：以上步骤可以省略。</span><br><span class="line"></span><br><span class="line">6）创建第一个基于mpvue的小程序项目代码</span><br><span class="line">	vue init mpvue&#x2F;mpvue-quickstart mpvuepro</span><br><span class="line"></span><br><span class="line">	? Project name mpvuepro</span><br><span class="line">    ? wxmp appid touristappid</span><br><span class="line">    ? Project description A Mpvue project</span><br><span class="line">    ? Author kevinzhang &lt;kevin.zhang@moredist.com&gt;</span><br><span class="line">    ? Vue build runtime</span><br><span class="line">    ? Use Vuex? Yes</span><br><span class="line">    ? Use ESLint to lint your code? No</span><br><span class="line">    ? Pick an ESLint preset Standard</span><br><span class="line">    ? 小程序测试，敬请关注最新微信开发者工具的“测试报告”功能 </span><br><span class="line"></span><br><span class="line">   vue-cli · Generated &quot;mpvuepro&quot;.</span><br><span class="line"></span><br><span class="line">   To get started:   </span><br><span class="line">        cd mpvuepro</span><br><span class="line">        npm install</span><br><span class="line">        npm run dev   </span><br><span class="line">   Documentation can be found at http:&#x2F;&#x2F;mpvue.com</span><br><span class="line">7）初始化：</span><br><span class="line">    cd mpvuepro </span><br><span class="line">    npm install</span><br><span class="line">8）编译:npm run dev</span><br><span class="line">	编译后的代码会在dist目录下</span><br><span class="line">9）修改项目的appid</span><br><span class="line">	打开mpvuepro下project.config.json，改为：</span><br><span class="line">	&quot;appid&quot;: &quot;自己的appid&quot;</span><br><span class="line">10）打开微信开发者工具，选择新增项目或者导入项目：</span><br><span class="line">	项目目录选择指向mpvuepro目录,点击“确定”按钮，进入小程序开发主界面，在左边的小程序模拟器中就能看到mpvuepro小程序的执行结果了。</span><br><span class="line"></span><br><span class="line">	【提醒】记得在微信开发者工具的菜单-&gt;设置-&gt;编辑设置 中，将“保存时自动编译小程序”勾选上，这样当mpvue的代码自动编译完成后，模拟器才会自动刷新界面。</span><br></pre></td></tr></table></figure>

<h3 id="9-文档结构"><a href="#9-文档结构" class="headerlink" title="9.文档结构"></a>9.文档结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">app</span><br><span class="line">├── package.json</span><br><span class="line">├── project.config.json       </span><br><span class="line">├── static            </span><br><span class="line">├── src</span><br><span class="line">│    ├── components</span><br><span class="line">│    ├── pages</span><br><span class="line">│    ├── utils</span><br><span class="line">│    ├── App.vue</span><br><span class="line">│    └── main.js</span><br><span class="line">├── config</span><br><span class="line">│   ├── index.js</span><br><span class="line">│   ├── dev.env.js</span><br><span class="line">│   └── prod.env.js</span><br><span class="line">└── build</span><br><span class="line"></span><br><span class="line">1）package.json文件</span><br><span class="line">	package.json是项目的主配置文件，里面包含了mpvue项目的基本描述信息、项目所依赖的各种第三方库以及版本信息、以及可执行的脚本信息。</span><br><span class="line">2）project.config.json文件</span><br><span class="line">	project.config.json文件是用于管理微信开发者工具的小程序项目的配置文件，其中记录了小程序的appid、代码主目录、以及编译选项等等信息，在微信开发者工具中导入小程序项目的时候主要是通过该配置文件读取和写入配置信息。</span><br><span class="line">3）static目录</span><br><span class="line">	static目录可以用于存放各种小程序本地静态资源，如图片、文本文件、css样式、音频、视频等。代码中可通过相对路径或绝对路径进行访问， 如：</span><br><span class="line">    &lt;img src&#x3D;&quot;&#x2F;static&#x2F;button.png&quot; &#x2F;&gt;</span><br><span class="line">    &lt;img src&#x3D;&quot;..&#x2F;..&#x2F;..&#x2F;static&#x2F;button.png&quot; &#x2F;&gt;</span><br><span class="line">4）build目录</span><br><span class="line">	build目录下是一些用于项目编译打包的node.js脚本和webpack配置文件。一般情况下不需要修改这些文件。</span><br><span class="line">5）config目录</span><br><span class="line">	config目录下包含了用于开发和生产环境下的不同配置，dev.env.js用于开发环境，prod.env.js用于生产环境，你可以将开发阶段和生产阶段不一样的信息（如后台API的url地址等）配置到这两个文件中去，然后在代码中以变量的形式进行引用。例如，这2个文件中分别配置了不同的API_BASE_URL值：</span><br><span class="line">    &#x2F;&#x2F; dev.env.js</span><br><span class="line">    module.exports &#x3D; merge(prodEnv, &#123;</span><br><span class="line">      NODE_ENV: &#39;&quot;development&quot;&#39;,</span><br><span class="line">      API_BASE_URL: &#39;http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;api&#39;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; prod.env.js</span><br><span class="line">    module.exports &#x3D; &#123;</span><br><span class="line">      NODE_ENV: &#39;&quot;production&quot;&#39;,</span><br><span class="line">      API_BASE_URL: &#39;&quot;https:&#x2F;&#x2F;www.my-domain.com&#x2F;api&quot;&#39;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    那你在编写请求后端API的代码时，你就可以使用这个环境配置，像这样：</span><br><span class="line">    const baseURL &#x3D; process.env.API_BASE_URL</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">      url: $&#123;baseURL&#125;&#x2F;products</span><br><span class="line">    &#125;)</span><br><span class="line">	这样一来，开发阶段和上线发布阶段的环境可以清楚的区分开来。</span><br><span class="line">6）src目录</span><br><span class="line">	src目录是我们主要进行小程序功能编写的地方。默认生成的demo代码为我们创建了几个子目录：</span><br><span class="line">    components、pages和utils，还有2个文件：App.vue和main.js。其实它们都不是必须的，可以按照自己的风格进行定义和配置。不过默认创建的这个结构基本上是一个约定俗成的结构了，比较易于理解，所以我们可以遵循这个结构进行开发。</span><br><span class="line">	components：在实际开发中，我们可以尽量将界面上可复用的部分，提取成vue组件放入该目录</span><br><span class="line">	pages：存放小程序的页面。请遵循每个小程序页面放入一个单独子目录的组织形式</span><br><span class="line">	utils：可选（可删）。可以将代码中一些公用工具函数组织成模块放入该目录下</span><br><span class="line">	可新建其他目录，存放你希望组织起来的代码。比如公用的业务逻辑代码、请求后台API的代码等等</span><br><span class="line">	main.js + App.vue：这两个是入口文件，相当于原生小程序框架中的app.json和app.js的复合体。</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1）用mpvue开发微信小程序时，不需要使用vue中的vue-router路由插件，它直接用src目录中的app.json中的pages配置路由；</span><br><span class="line">   &quot;pages&quot;: [</span><br><span class="line">       &quot;pages&#x2F;index&#x2F;main&quot;,</span><br><span class="line">       &quot;pages&#x2F;logs&#x2F;main&quot;,</span><br><span class="line">       &quot;pages&#x2F;counter&#x2F;main&quot;</span><br><span class="line">     ]</span><br><span class="line">2）在vue.js使用axios发请求，在mpvue中可以直接使用wx.request发请求。</span><br></pre></td></tr></table></figure>

<h3 id="10-WeUI"><a href="#10-WeUI" class="headerlink" title="10.WeUI"></a>10.WeUI</h3><p>　　WeUI是微信团队开发的一个用于开发小程序的UI框架。</p>
<p>　　文档网址：<a href="http://weui.moocba.com" target="_blank" rel="noopener">http://weui.moocba.com</a></p>
<h3 id="11-weUI使用步骤"><a href="#11-weUI使用步骤" class="headerlink" title="11.weUI使用步骤"></a>11.weUI使用步骤</h3><p>　　1）进入网站，下载源码</p>
<p><img src="02.png" alt=""></p>
<p>　　2）解压后将dist-&gt;style下的文件全部复制到项目中</p>
<p><img src="01.png" alt=""></p>
<p>　　3）全局（src-&gt;main.js）或在要使用weUI的组件的文件的样式文件中引入样式文件，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#39;..&#x2F;static&#x2F;css&#x2F;weui.wxss&#39;</span><br></pre></td></tr></table></figure>

<p>　　4）使用weUI中封装好的组件，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;main&quot;&gt;</span><br><span class="line">    &lt;view class&#x3D;&quot;weui-btn-area&quot;&gt;</span><br><span class="line">      &lt;picker @change&#x3D;&quot;bindPickerChange($event)&quot; :value&#x3D;&quot;index&quot; :range&#x3D;&quot;array&quot;&gt;</span><br><span class="line">        &lt;button type&#x3D;&quot;default&quot;&gt;单列选择器&lt;&#x2F;button&gt;</span><br><span class="line">      &lt;&#x2F;picker&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        array: [&quot;中国&quot;, &quot;美国&quot;, &quot;巴西&quot;, &quot;日本&quot;],</span><br><span class="line">        index: 0,</span><br><span class="line">        txt: &#39;&#39;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      bindPickerChange(e)&#123;</span><br><span class="line">        console.log(this.array[e.target.value])</span><br><span class="line">        this.txt &#x3D; this.array[e.target.value]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="12-开发示例"><a href="#12-开发示例" class="headerlink" title="12.开发示例"></a>12.开发示例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; 程序入口:</span><br><span class="line">1）app.json &#x3D;&gt; src&#x2F;main.js</span><br><span class="line">2）app.js &#x3D;&gt; src&#x2F;App.vue</span><br><span class="line">3）首页(index子目录) &#x3D;&gt; index子目录(index.vue,main.js)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; 编写新页面</span><br><span class="line">1）创建src&#x2F;pages&#x2F;hello文件夹</span><br><span class="line">2）hello文件夹下创建main.js和index.vue两个文件</span><br><span class="line">3）main.js代码:</span><br><span class="line">    import Vue from &#39;vue&#39;</span><br><span class="line">    import App from &#39;.&#x2F;index&#39;</span><br><span class="line"></span><br><span class="line">    const app &#x3D; new Vue(App)</span><br><span class="line">    app.$mount()</span><br><span class="line">4）index.vue代码:</span><br><span class="line">    &lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&#39;message&#39; @click&#x3D;&#39;dian&#39;&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        export default &#123;</span><br><span class="line">            data () &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg:&#39;hello,world&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods:&#123;</span><br><span class="line">                dian(e)&#123;</span><br><span class="line">                    this.msg&#x3D;&#39;你好,世界&#39;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;style scoped&gt;</span><br><span class="line">        .message&#123;</span><br><span class="line">            background:gray;</span><br><span class="line">            color:red;</span><br><span class="line">            text-align:center;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">5）修改src&#x2F;app.json:</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;pages&quot;: [</span><br><span class="line">        &quot;pages&#x2F;hello&#x2F;main&quot;,</span><br><span class="line">        &quot;pages&#x2F;index&#x2F;main&quot;,</span><br><span class="line">        &quot;pages&#x2F;logs&#x2F;main&quot;,</span><br><span class="line">        &quot;pages&#x2F;counter&#x2F;main&quot;</span><br><span class="line">      ],</span><br><span class="line">    ...</span><br><span class="line">6）编译：npm run dev</span><br><span class="line">7）小程序开发者工具上查看效果</span><br><span class="line">	可以看到，这个组件完全看不到小程序写法的影子，而是全部由Vue开发Web应用的写法来完成：数据绑定、事件处理、scoped局部样式、以及使用HTML标签来构建界面。这样最大化的保持和网页应用开发一致，减少了前端人员切换到小程序的学习理解成本，也为原先使用Vue开发的网页应用移植到小程序平台提供了降低迁移成本的可能。</span><br><span class="line">	</span><br><span class="line">	模板部分我们通常可以用HTML标签来写，比如div、span等，它们会在编译的时候被自动转换成小程序的原生组件view、text之类；而那些小程序特有的组件如swiper、rich-text等，可以直接在模板中使用。</span><br><span class="line">	</span><br><span class="line">	在原生小程序的页面（Page）中包含了很多页面的生命周期方法，如onLoad、onUnload、onShow、onHide、onPullDownRefresh等等，mpvue中推荐使用Vue组件生命周期方法，而像onPullDownRefresh、onReachBottom这类特殊功能的生命周期则需直接使用原生的。</span><br></pre></td></tr></table></figure>

<h3 id="13-整理项目文件夹"><a href="#13-整理项目文件夹" class="headerlink" title="13.整理项目文件夹"></a>13.整理项目文件夹</h3><p><img src="03.png" alt=""></p>
<h3 id="14-修改配置文件app-json"><a href="#14-修改配置文件app-json" class="headerlink" title="14.修改配置文件app.json"></a>14.修改配置文件app.json</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pages&quot;: [</span><br><span class="line">    &quot;pages&#x2F;home&#x2F;main&quot;,</span><br><span class="line">    &quot;pages&#x2F;classic&#x2F;main&quot;,</span><br><span class="line">    &quot;pages&#x2F;brand&#x2F;main&quot;,</span><br><span class="line">    &quot;pages&#x2F;team&#x2F;main&quot;,</span><br><span class="line">    &quot;pages&#x2F;mine&#x2F;main&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;window&quot;: &#123;</span><br><span class="line">    &quot;backgroundTextStyle&quot;: &quot;light&quot;,</span><br><span class="line">    &quot;navigationBarBackgroundColor&quot;: &quot;#fff&quot;,</span><br><span class="line">    &quot;navigationStyle&quot;: &quot;custom&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tabBar&quot;: &#123;</span><br><span class="line">    &quot;color&quot;: &quot;#999&quot;,</span><br><span class="line">    &quot;backgroundColor&quot;: &quot;#fafafa&quot;,</span><br><span class="line">    &quot;selectedColor&quot;: &quot;#333&quot;,</span><br><span class="line">    &quot;borderStyle&quot;: &quot;white&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;list&quot;: [&#123;</span><br><span class="line">      &quot;text&quot;: &quot;首页&quot;,</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages&#x2F;home&#x2F;main&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;static&#x2F;tabs&#x2F;home.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;static&#x2F;tabs&#x2F;home-active.png&quot;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      &quot;text&quot;: &quot;分类&quot;,</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages&#x2F;classic&#x2F;main&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders-active.png&quot;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      &quot;text&quot;: &quot;品牌&quot;,</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages&#x2F;brand&#x2F;main&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders-active.png&quot;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      &quot;text&quot;: &quot;团购&quot;,</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages&#x2F;team&#x2F;main&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders-active.png&quot;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      &quot;text&quot;: &quot;我&quot;,</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages&#x2F;mine&#x2F;main&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;static&#x2F;tabs&#x2F;orders-active.png&quot;</span><br><span class="line">    &#125;],</span><br><span class="line">    &quot;position&quot;: &quot;bottom&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>开发时选项卡选项只能是2-3项！！！</p>
<h3 id="15-页面初始内容，下面以brand页面为例"><a href="#15-页面初始内容，下面以brand页面为例" class="headerlink" title="15.页面初始内容，下面以brand页面为例"></a>15.页面初始内容，下面以brand页面为例</h3><p>brand.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;main&quot;&gt;</span><br><span class="line">    brand</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Brand from &#39;.&#x2F;brand&#39;</span><br><span class="line"></span><br><span class="line">let brand &#x3D; new Vue(Brand);</span><br><span class="line">brand.$mount();</span><br></pre></td></tr></table></figure>

<h3 id="16-页面跳转"><a href="#16-页面跳转" class="headerlink" title="16.页面跳转"></a>16.页面跳转</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.vue代码 --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">	&lt;div class&#x3D;&#39;message&#39; @click&#x3D;&#39;dian&#39;&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">	&lt;a href&#x3D;&#39;&#x2F;pages&#x2F;counter&#x2F;main&#39;&gt;跳转到conter&lt;&#x2F;a&gt;</span><br><span class="line">	&lt;div @click&#x3D;&#39;jump&#39;&gt;跳转到首页&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        data () &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                msg:&#39;hello,world&#39;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">            dian(e)&#123;</span><br><span class="line">                this.msg&#x3D;&#39;你好,世界&#39;;</span><br><span class="line">            &#125;,</span><br><span class="line">            jump(e)&#123;</span><br><span class="line">                let url &#x3D; &#39;..&#x2F;index&#x2F;main&#39;;</span><br><span class="line">                &#x2F;&#x2F;wx.navigateTo(&#123;url&#125;);</span><br><span class="line">                wx.switchTab(&#123;url&#125;);&#x2F;&#x2F;选项卡（路由）跳转要使用这种方式</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">    .message&#123;</span><br><span class="line">        background:gray;</span><br><span class="line">        color:red;</span><br><span class="line">        text-align:center;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>　　Tip:</p>
<p>　　　　mpvue中不再支持vue-router，跳转方式为：</p>
<p>　　1）静态跳转</p>
<p>　　　　a.a标签实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&#39;&#x2F;pages&#x2F;counter&#x2F;main&#39;&gt;跳转到conter&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>　　　　b.navigator实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;navigator href&#x3D;&#39;&#x2F;pages&#x2F;counter&#x2F;main&#39;&gt;跳转到conter&lt;&#x2F;navigator&gt;</span><br></pre></td></tr></table></figure>

<p>　　　　c.首页的跳转 navigator open-type设置为switchTab 可跳转到 tabBar页面！！！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;navigator open-type&#x3D;&quot;switchTab&quot; url&#x3D;&quot;&#x2F;pages&#x2F;tab1&#x2F;main&quot;&gt;</span><br><span class="line">    ....</span><br><span class="line">&lt;&#x2F;navigator&gt;</span><br></pre></td></tr></table></figure>

<p>　　2）动态跳转</p>
<p>　　a.页面内跳转</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.navigatorTo(&#123;</span><br><span class="line">    url:&#39;&#x2F;pages&#x2F;counter&#x2F;main&#39;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>　　b.跳转到tabbar</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.switchTab(&#123;</span><br><span class="line">    url:&#39;&#x2F;pages&#x2F;index&#x2F;main&#39;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>　　有6种动态跳转方式，可以参阅微信小程序官方文档，上面是最常用的方式。</p>
<h3 id="18-vuex使用"><a href="#18-vuex使用" class="headerlink" title="18.vuex使用"></a>18.vuex使用</h3><p>　　1）在src创建目录store，在store中创建index.js文件，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Vuex from &#39;vuex&#39;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex);</span><br><span class="line"></span><br><span class="line">const store &#x3D; new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    name: &#39;隔壁老王&#39;,</span><br><span class="line">    age: 18</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    changedata(state,info)&#123;</span><br><span class="line">      state.name &#x3D; info.name;</span><br><span class="line">      state.age &#x3D; info.age;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default store</span><br></pre></td></tr></table></figure>

<p>　　2）在要使用vuex的当前组件中引入数据仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import store from &#39;.&#x2F;store&#39;</span><br></pre></td></tr></table></figure>

<p>　　3）页面使用仓库中的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">export default&#123;</span><br><span class="line">    computed:&#123;</span><br><span class="line">      getName()&#123;</span><br><span class="line">        return store.state.name</span><br><span class="line">      &#125;,</span><br><span class="line">      age()&#123;</span><br><span class="line">        return store.state.age</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　4）页面渲染</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&#123;&#123; name &#125;&#125;----&#123;&#123; age &#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>　　5）修改仓库中的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;main&quot;&gt;</span><br><span class="line">    name:&lt;input type&#x3D;&quot;text&quot; v-model&#x3D;&quot;name&quot;&gt; &lt;br&gt;</span><br><span class="line">    age:&lt;input type&#x3D;&quot;number&quot; v-model&#x3D;&quot;age&quot;&gt; &lt;br&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;button&quot; @click&#x3D;&quot;changeData&quot; value&#x3D;&quot;提交&quot;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import store from &#39;..&#x2F;..&#x2F;store&#39;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        name: &#39;&#39;,</span><br><span class="line">        age: 0</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      changeData() &#123;</span><br><span class="line">        store.commit(&#39;changedata&#39;,&#123;name:this.name,age:this.age&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="19-利用wx-request发请求，不需要安装axios"><a href="#19-利用wx-request发请求，不需要安装axios" class="headerlink" title="19.利用wx.request发请求，不需要安装axios"></a>19.利用wx.request发请求，不需要安装axios</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">    wx.request(&#123;</span><br><span class="line">        method: &#39;GET&#39;,</span><br><span class="line">        url: &#39;https:&#x2F;&#x2F;lovehou.applinzi.com&#x2F;gethomedata.php&#39;,</span><br><span class="line">        success(res)&#123;</span><br><span class="line">        	console.log(res)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="20-mpvue中的坑"><a href="#20-mpvue中的坑" class="headerlink" title="20.mpvue中的坑"></a>20.mpvue中的坑</h3><h4 id="21-1-background-image-图片引用的问题"><a href="#21-1-background-image-图片引用的问题" class="headerlink" title="21.1 background-image 图片引用的问题"></a>21.1 background-image 图片引用的问题</h4><p>　　设置比较小的图片是没有影响的，但是比较大的图片就会发现没有效果。</p>
<p>　　在 webpack.base.conf.js 中 url-loader 的相关设置对图片大小有限制。可以取消这个限制，同时使用绝对路径访问就会避免这个问题了。一般其实是放在 src/assets 目录下，然后通过 ~@/assets/xxx 这样引用的。</p>
<p> 　　Ps：因为小程序对大小有限制(多个包最大4M，单个2M)，所以尽量不要使用本地图片。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: &#x2F;\.(png|jpe?g|gif|svg)(\?.*)?$&#x2F;,</span><br><span class="line">    loader: &#39;url-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">         limit: 100,</span><br><span class="line">         name: utils.assetsPath(&#39;img&#x2F;[name].[ext]&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h4 id="21-2-bind-style-后设置-backgroundImage-的-url"><a href="#21-2-bind-style-后设置-backgroundImage-的-url" class="headerlink" title="21.2 bind style 后设置 backgroundImage 的 url"></a>21.2 bind style 后设置 backgroundImage 的 url</h4><p>　　bind style 后设置 backgroundImage 的 url ：最后以这种方式实现了效果，但是会报错…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;div :style&#x3D;&quot;&#123;backgroundImage: &#39;url(&#39; + pictures.background + &#39;)&#39;&#125;&quot;&gt;</span><br><span class="line">&lt;div :style&#x3D;&quot;&#123;backgroundImage: url($&#123;pictures.exampleCard&#125;)&#125;&quot;&gt;&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="21-3-小程序事件绑定的写法"><a href="#21-3-小程序事件绑定的写法" class="headerlink" title="21.3 小程序事件绑定的写法"></a>21.3 小程序事件绑定的写法</h4><p>　　错把 bindgetuserinfo 当成了一个属性…设置了半天都不好用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button open-type&#x3D;&quot;getUserInfo&quot; bindgetuserinfo&#x3D;&quot;getInfo&quot;&gt;点击登录&lt;&#x2F;button&gt; &#x2F;&#x2F; 小程序</span><br><span class="line">&lt;button open-type&#x3D;&quot;getUserInfo&quot; @getuserinfo&#x3D;&quot;getInfo&quot;&gt;点击登录&lt;&#x2F;button&gt;  &#x2F;&#x2F; mpvue</span><br></pre></td></tr></table></figure>

<h4 id="21-4-获取表单-formId"><a href="#21-4-获取表单-formId" class="headerlink" title="21.4 获取表单 formId"></a>21.4 获取表单 formId</h4><p>　　获取事件 event 对象的值时，在 event 后加一个 mp。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;form @submit&#x3D;&quot;formSubmit&quot; report-submit&gt;</span><br><span class="line">  &lt;button plain class&#x3D;&quot;idBtn&quot; form-type&#x3D;&quot;submit&quot; data-type&#x3D;&quot;click&quot;&gt;&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line"></span><br><span class="line">formSubmit (e) &#123;</span><br><span class="line">    let formId &#x3D; e.mp.detail.formId &#x2F;&#x2F; mpvue</span><br><span class="line">    let formId &#x3D; e.detail.formId &#x2F;&#x2F; 小程序</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="21-5-获取页面跳转链接拼接的-query"><a href="#21-5-获取页面跳转链接拼接的-query" class="headerlink" title="21.5 获取页面跳转链接拼接的 query"></a>21.5 获取页面跳转链接拼接的 query</h4><p>　　获取页面跳转链接拼接的 query 时，mpvue 进行了优化，通过 this.$root.$mp.query 来获取。</p>
<h4 id="21-6-v-model"><a href="#21-6-v-model" class="headerlink" title="21.6  v-model"></a>21.6  v-model</h4><p>　　在实现双向数据绑定的时候尽量使用 v-model.lazy ，以优化性能减去出现 bug 的可能性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type&#x3D;&quot;text&quot; v-model.lazy:value&#x3D;&quot;englishName&quot; placeholder&#x3D;&quot;请输入&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="21-7-页面的刷新问题"><a href="#21-7-页面的刷新问题" class="headerlink" title="21.7 页面的刷新问题"></a>21.7 页面的刷新问题</h4><p>　　因为小程序是没办法 window.reload 的所以在 onLoad 或者 onShow 的时候去调用数据接口就可以了。</p>
<h4 id="21-8-scroll-view-组件的一些问题"><a href="#21-8-scroll-view-组件的一些问题" class="headerlink" title="21.8 scroll-view 组件的一些问题"></a>21.8 scroll-view 组件的一些问题</h4><p>　　并不推荐使用这个组件，也不是mpvue的问题，就是这个组件本身就不太好用。</p>
<ul>
<li>事件触发不了的问题<br> 在mpvue中使用下面的一些事件的时候是不会触发的</li>
<li>bindscrolltolower</li>
<li>bindscrolltoupper</li>
<li>bindscroll</li>
</ul>
<p>　　解决方法你猜是什么？就是把bind去掉。</p>
<ul>
<li>scrolltolower</li>
<li>scrolltoupper</li>
<li>scroll</li>
</ul>
<p>　　然而，当 scroll-view 高度为 100% 的时候 bindscrolltolower 又不执行了，解决方法是给外面的父元素加一些限制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;cat-scroll&quot;&gt;</span><br><span class="line">    &lt;scroll-view style&#x3D;&quot;height: 100%; width: 100%&quot;&gt;</span><br><span class="line">    &lt;&#x2F;&lt;scroll-view&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">.cat-scroll &#123;</span><br><span class="line">position: absolute;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　这样就解决了，但，这样铺满屏幕后和小程序的下拉刷新冲突了，导致下拉刷新不执行。</p>
<p>　　回到我们开头说的不用 scroll-view 我们用别的方法解决。首先我们使用 scroll-view的原因一般就是做一个下拉加载更多么，在小程序中页面全局有一个滚动到底部的事件 onReachBottom 我们只需要在这个事件里面写上拉加载更多就好了，和下拉刷新也不冲突。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">    onPullDownRefresh()&#123;</span><br><span class="line">        &#x2F;&#x2F;  下拉刷新</span><br><span class="line">    &#125;,</span><br><span class="line">    onReachBottom()&#123;</span><br><span class="line">        &#x2F;&#x2F; 上拉加载更多</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="21-9-v-for"><a href="#21-9-v-for" class="headerlink" title="21.9 v-for"></a>21.9 v-for</h4><p>　　要写：key=””，要不然编译会警告。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v-for&#x3D;&quot;(item, index) in list&quot; :key&#x3D;&quot;item.name&quot;</span><br></pre></td></tr></table></figure>

<h4 id="21-10-获取授权用户信息"><a href="#21-10-获取授权用户信息" class="headerlink" title="21.10 获取授权用户信息"></a>21.10 获取授权用户信息</h4><p>　　改版后使用wx.getUserInfo()不再弹出授权弹窗：<br>　　解决方案：使用wx.getSetting，成功回调里判断是否授权过用户信息。if (res.authSetting[‘scope.userInfo’])</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 判断用户授权信息并做相应处理</span><br><span class="line">wx.getSetting(&#123;</span><br><span class="line">  success(res) &#123;</span><br><span class="line">    if (res.authSetting[&#39;scope.userInfo&#39;]) &#123;</span><br><span class="line">      &#x2F;&#x2F; 已经授权，可以直接调用 getUserInfo 获取头像昵称</span><br><span class="line">      wx.getUserInfo(&#123;</span><br><span class="line">        success: function(data) &#123;</span><br><span class="line">          console.log(data.userInfo)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    &#x2F;&#x2F; 没有授权过的用户，跳转到自己写的授权提示页面</span><br><span class="line">      wx.navigateTo(&#123;</span><br><span class="line">        url: &#39;&#x2F;pages&#x2F;getUserInfo&#x2F;main&#39;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; getUserInfo页面</span><br><span class="line">&#x2F;&#x2F; 用户点击允许，这里有个坑</span><br><span class="line">&#x2F;&#x2F; 原生wx的写法</span><br><span class="line">&lt;button plain&#x3D;&#39;true&#39; open-type&#x3D;&#39;getUserInfo&#39; getuserinfo&#x3D;&#39;onGotUserInfo&#39;&gt;允许&lt;&#x2F;button&gt;</span><br><span class="line">&#x2F;&#x2F; 使用mpvue的写法，点击事件，要加上@符号</span><br><span class="line">&lt;button plain&#x3D;&#39;true&#39; open-type&#x3D;&#39;getUserInfo&#39; @getuserinfo&#x3D;&#39;onGotUserInfo&#39;&gt;允许&lt;&#x2F;button&gt;</span><br><span class="line">&#x2F;&#x2F; 点击的methods方法</span><br><span class="line">methods: &#123;</span><br><span class="line">  onGotUserInfo(e) &#123;</span><br><span class="line">    &#x2F;&#x2F; 数据是e.mp</span><br><span class="line">    console.log(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="21-11-小程序点击组件在某些手机跳转不起作用"><a href="#21-11-小程序点击组件在某些手机跳转不起作用" class="headerlink" title="21.11 小程序点击组件在某些手机跳转不起作用"></a>21.11 小程序点击<navagator>组件在某些手机跳转不起作用</h4><p>　　navagator组件需要2.07以上基础库支持，当你的微信版本过低，所支持的基础库也就低，导致跳转无效。</p>
<p>　　<strong>解决方案：</strong> 在微信公众平台设置-&gt;基本设置-&gt; 基础库最低版本设置 ,设置线上最低版本库为组件所支持的最低版本。</p>
<h3 id="22-弹框"><a href="#22-弹框" class="headerlink" title="22.弹框"></a>22.弹框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p @click&#x3D;&quot;showDialog&quot;&gt;课程学习提示&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  methods:&#123;</span><br><span class="line">    showDialog()&#123;</span><br><span class="line">      wx.showModal(&#123;</span><br><span class="line">        title: &#39;规则说明&#39;,</span><br><span class="line">        content: 学习：课程为闯关模式，学完一课，第二天自动解锁下一课，每天最多学习一节课哦~ \r\n打卡：完成当日学习后，将学习报告分享至宝妈群，即为打卡成功！仅当日分享有效哦~ \r\n连续打卡12天，即可免费领取神秘大奖,</span><br><span class="line">        showCancel: true,</span><br><span class="line">        confirmText: &#39;知道啦&#39;,</span><br><span class="line">        success: function(res) &#123;</span><br><span class="line">          if (res.confirm) &#123;</span><br><span class="line">            console.log(&#39;用户点击确定&#39;)</span><br><span class="line">          &#125; else if (res.cancel) &#123;</span><br><span class="line">            console.log(&#39;用户点击取消&#39;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="23-mpvue-iview-一个基于mpvue的UI组件库"><a href="#23-mpvue-iview-一个基于mpvue的UI组件库" class="headerlink" title="23.mpvue-iview 一个基于mpvue的UI组件库"></a>23.mpvue-iview 一个基于mpvue的UI组件库</h3><p>　　PS：可以自学，不过用处也不是太大，也可以使用其它UI框架。</p>
<p>　　官网地址：<a href="https://weapp.iviewui.com/docs/guide/start" target="_blank" rel="noopener">https://weapp.iviewui.com/docs/guide/start</a></p>
<h3 id="24-小程序之分包加载"><a href="#24-小程序之分包加载" class="headerlink" title="24.小程序之分包加载"></a>24.小程序之分包加载</h3><p>　　小程序包大小不得超过2M，到了提交发布代码这关键一步，却因为代码体积超限迫使含辛茹苦撸出的小程序胎死腹中。<br>　　现如今官方推出小程序分包加载这一共功能，动手之前建议认真阅读<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages.html" target="_blank" rel="noopener">官方文档</a>。</p>
<h4 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h4><p>　　微信 6.6 客户端，1.7.3 及以上基础库开始支持，请更新至最新客户端版本，开发者工具请使用 1.01.1712150 及以上版本，可<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener">点此下载</a>。</p>
<h4 id="如何分包"><a href="#如何分包" class="headerlink" title="如何分包"></a>如何分包</h4><p>　　在构建小程序分包项目时，构建会输出一个或多个功能的分包，其中每个分包小程序必定含有一个主包，所谓的主包，即放置默认启动页面/TabBar 页面，以及一些所有分包都需用到公共资源/JS 脚本，而分包则是根据开发者的配置进行划分。</p>
<p>　　目前小程序分包大小有以下限制：<br>　　<strong>整个小程序所有分包大小不超过 8M单个分包/主包大小不能超过 2M</strong></p>
<p>　　在小程序启动时，默认会下载主包并启动主包内页面，如果用户需要打开分包内某个页面，客户端会把对应分包下载下来，下载完成后再进行展示。对小程序进行分包，可以优化小程序首次启动的下载时间，以及在多团队共同开发时可以更好的解耦协作。</p>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>　　假设支持分包的小程序目录结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">├── app.js</span><br><span class="line">├── app.json</span><br><span class="line">├── app.wxss</span><br><span class="line">├── packageA</span><br><span class="line">│   └── pages</span><br><span class="line">│       ├── cat</span><br><span class="line">│       └── dog</span><br><span class="line">├── packageB</span><br><span class="line">│   └── pages</span><br><span class="line">│       ├── apple</span><br><span class="line">│       └── banana</span><br><span class="line">├── pages</span><br><span class="line">│   ├── index</span><br><span class="line">│   └── logs</span><br><span class="line">└── utils</span><br></pre></td></tr></table></figure>

<p>　　开发者通过在 app.json subPackages 字段声明项目分包结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pages&quot;:[</span><br><span class="line">    &quot;pages&#x2F;index&quot;,</span><br><span class="line">    &quot;pages&#x2F;logs&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;subPackages&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;root&quot;: &quot;packageA&quot;,</span><br><span class="line">      &quot;pages&quot;: [</span><br><span class="line">        &quot;pages&#x2F;cat&quot;,</span><br><span class="line">        &quot;pages&#x2F;dog&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      &quot;root&quot;: &quot;packageB&quot;,</span><br><span class="line">      &quot;pages&quot;: [</span><br><span class="line">        &quot;pages&#x2F;apple&quot;,</span><br><span class="line">        &quot;pages&#x2F;banana&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="打包原则"><a href="#打包原则" class="headerlink" title="打包原则"></a>打包原则</h4><ul>
<li>声明 subPackages 后，将按 subPackages 配置路径进行打包，subPackages 配置路径外的目录将被打包到 app（主包） 中</li>
<li>app（主包）也可以有自己的 pages（即最外层的 pages 字段）</li>
<li>subPackage 的根目录不能是另外一个 subPackage 内的子目录</li>
<li>首页的 TAB 页面必须在 app（主包）内</li>
</ul>
<h4 id="引用原则"><a href="#引用原则" class="headerlink" title="引用原则"></a>引用原则</h4><ul>
<li>packageA 无法 require packageB JS 文件，但可以 require app、自己 package 内的 JS 文件</li>
<li>packageA 无法 import packageB 的 template，但可以 require app、自己 package 内的 template</li>
<li>packageA 无法使用 packageB 的资源，但可以使用 app、自己 package 内的资源</li>
</ul>
<h3 id="25-vue-js与微信小程序的不同"><a href="#25-vue-js与微信小程序的不同" class="headerlink" title="25.vue.js与微信小程序的不同"></a>25.vue.js与微信小程序的不同</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue-router(用pages已配置好) axios(wx.request) localStorage&#x2F;sessionStorage(wx.setStorage&#x2F;wx.getStorage&#x2F;...) ref(api-&gt;wxml)</span><br></pre></td></tr></table></figure>

<h3 id="26-vue-js尽量减少DOM操作，微信小程序开发尽量避免DOM和BOM操作。"><a href="#26-vue-js尽量减少DOM操作，微信小程序开发尽量避免DOM和BOM操作。" class="headerlink" title="26.vue.js尽量减少DOM操作，微信小程序开发尽量避免DOM和BOM操作。"></a>26.vue.js尽量减少DOM操作，微信小程序开发尽量避免DOM和BOM操作。</h3><h3 id="27-node-js-express-mysql-https搭建后台"><a href="#27-node-js-express-mysql-https搭建后台" class="headerlink" title="27.node.js+express+mysql+https搭建后台"></a>27.node.js+express+mysql+https搭建后台</h3><p>1）搭建项目环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---  express -e jinman</span><br><span class="line"></span><br><span class="line">--- cd jinman</span><br><span class="line">--- npm i</span><br><span class="line">--- npm i mysql -S</span><br></pre></td></tr></table></figure>

<p>2）创建对应的数据库和数据表，下面以登录为例</p>
<p>a.表结构</p>
<p><img src="04.png" alt=""></p>
<p>b.表参考数据</p>
<p><img src="05.png" alt=""></p>
<p>3）修改项目中的app.js文件的内容</p>
<p><img src="06.png" alt=""></p>
<p>参考代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">var createError &#x3D; require(&#39;http-errors&#39;);</span><br><span class="line">var express &#x3D; require(&#39;express&#39;);</span><br><span class="line">var path &#x3D; require(&#39;path&#39;);</span><br><span class="line">var cookieParser &#x3D; require(&#39;cookie-parser&#39;);</span><br><span class="line">var logger &#x3D; require(&#39;morgan&#39;);</span><br><span class="line">var https &#x3D; require(&#39;https&#39;);</span><br><span class="line">var http &#x3D; require(&#39;http&#39;);</span><br><span class="line">var fs &#x3D; require(&#39;fs&#39;);</span><br><span class="line"></span><br><span class="line">var indexRouter &#x3D; require(&#39;.&#x2F;routes&#x2F;index&#39;);</span><br><span class="line">var usersRouter &#x3D; require(&#39;.&#x2F;routes&#x2F;users&#39;);</span><br><span class="line"></span><br><span class="line">var app &#x3D; express();</span><br><span class="line"></span><br><span class="line">const options &#x3D; &#123;</span><br><span class="line">	key: fs.readFileSync(&#39;.&#x2F;public&#x2F;key&#x2F;3043388_www.hspstudio.club.key&#39;),</span><br><span class="line">	cert: fs.readFileSync(&#39;.&#x2F;public&#x2F;key&#x2F;3043388_www.hspstudio.club.crt&#39;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var httpsServer &#x3D; https.createServer(options,app);</span><br><span class="line">var httpServer &#x3D; http.createServer(app);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; view engine setup</span><br><span class="line">app.set(&#39;views&#39;, path.join(__dirname, &#39;views&#39;));</span><br><span class="line">app.set(&#39;view engine&#39;, &#39;ejs&#39;);</span><br><span class="line"></span><br><span class="line">app.use(logger(&#39;dev&#39;));</span><br><span class="line">app.use(express.json());</span><br><span class="line">app.use(express.urlencoded(&#123; extended: false &#125;));</span><br><span class="line">app.use(cookieParser());</span><br><span class="line">app.use(express.static(path.join(__dirname, &#39;public&#39;)));</span><br><span class="line"></span><br><span class="line">app.use(&#39;&#x2F;&#39;, indexRouter);</span><br><span class="line">app.use(&#39;&#x2F;users&#39;, usersRouter);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; catch 404 and forward to error handler</span><br><span class="line">app.use(function(req, res, next) &#123;</span><br><span class="line">  next(createError(404));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; error handler</span><br><span class="line">app.use(function(err, req, res, next) &#123;</span><br><span class="line">  &#x2F;&#x2F; set locals, only providing error in development</span><br><span class="line">  res.locals.message &#x3D; err.message;</span><br><span class="line">  res.locals.error &#x3D; req.app.get(&#39;env&#39;) &#x3D;&#x3D;&#x3D; &#39;development&#39; ? err : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; render the error page</span><br><span class="line">  res.status(err.status || 500);</span><br><span class="line">  res.render(&#39;error&#39;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">httpsServer.listen(443, &#39;0.0.0.0&#39;);</span><br><span class="line">httpServer.listen(80, &#39;0.0.0.0&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; app;</span><br></pre></td></tr></table></figure>

<p>注意：证书文件要换成自己的！！！</p>
<p>4）配置路由（routes-&gt;index.js）</p>
<p><img src="07.png" alt=""></p>
<p>参考代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">var express &#x3D; require(&#39;express&#39;); &#x2F;&#x2F; 引入express框架模块文件</span><br><span class="line">var router &#x3D; express(); &#x2F;&#x2F; 创建路由对象</span><br><span class="line"></span><br><span class="line">var mysql &#x3D; require(&#39;mysql&#39;); &#x2F;&#x2F; 引入第三方模块文件mysql，用来远程操作数据库</span><br><span class="line"></span><br><span class="line">var conn &#x3D; mysql.createConnection(&#123; &#x2F;&#x2F; 创建数据库连接对象</span><br><span class="line">	host: &#39;localhost&#39;,</span><br><span class="line">	user: &#39;root&#39;,</span><br><span class="line">	password: &#39;root&#39;,</span><br><span class="line">	database: &#39;jinman&#39;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">conn.connect(() &#x3D;&gt; &#123;  &#x2F;&#x2F; 建立数据库连接</span><br><span class="line">	console.log(&#39;DB is connect success!&#39;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.all(&quot;*&quot;,function(req,res,next)&#123;  &#x2F;&#x2F; 解决跨域</span><br><span class="line">    &#x2F;&#x2F;设置允许跨域的域名，*代表允许任意域名跨域</span><br><span class="line">    res.header(&quot;Access-Control-Allow-Origin&quot;,&quot;*&quot;);</span><br><span class="line">    &#x2F;&#x2F;允许的header类型</span><br><span class="line">    res.header(&quot;Access-Control-Allow-Headers&quot;,&quot;content-type&quot;);</span><br><span class="line">    &#x2F;&#x2F;跨域允许的请求方式 </span><br><span class="line">    res.header(&quot;Access-Control-Allow-Methods&quot;,&quot;DELETE,PUT,POST,GET,OPTIONS&quot;);</span><br><span class="line">    if (req.method.toLowerCase() &#x3D;&#x3D; &#39;options&#39;)</span><br><span class="line">        res.send(200);  &#x2F;&#x2F;让options尝试请求快速结束</span><br><span class="line">    else</span><br><span class="line">        next();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.all(&#39;&#x2F;swiper&#39;, function(req, res, next) &#123; &#x2F;&#x2F; 配置路由，用来获取swiper数据</span><br><span class="line">  conn.query(&#39;select * from swiper&#39;, (err,rs) &#x3D;&gt; &#123;</span><br><span class="line">  	if(err) throw err;</span><br><span class="line">  	else res.json(&#123;errorCode: 0, data:rs&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; router;  &#x2F;&#x2F; 将router暴露出去，以便在app.js中用require引入该模块中router对象</span><br></pre></td></tr></table></figure>

<p>5）启动服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node app</span><br></pre></td></tr></table></figure>

<h3 id="28-关于H5页面和微信小程序在iPhoneX刘海屏适配"><a href="#28-关于H5页面和微信小程序在iPhoneX刘海屏适配" class="headerlink" title="28.关于H5页面和微信小程序在iPhoneX刘海屏适配"></a>28.关于H5页面和微信小程序在iPhoneX刘海屏适配</h3><h4 id="28-1-iPhoneX的介绍"><a href="#28-1-iPhoneX的介绍" class="headerlink" title="28.1 iPhoneX的介绍"></a>28.1 iPhoneX的介绍</h4><p><strong>屏幕尺寸</strong></p>
<p>我们熟知的iPhone系列开发尺寸概要如下：</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106190827294-1199751417.png" alt="img"></p>
<p>△ iPhone各机型的开发尺寸</p>
<p>转化成我们熟知的像素尺寸：</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106190848122-865769222.png" alt="img"></p>
<p>△ 每个机型的多维度尺寸</p>
<p>倍图其实就是像素尺寸和开发尺寸的倍率关系，但这只是外在的表现。倍图核心的影响因素在于PPI（DPI）。</p>
<p>iPhone8在本次升级中，屏幕尺寸和分辨率都遗传了iPhone6以后的优良传统；</p>
<p>然而iPhone X 无论是在屏幕尺寸、分辨率、甚至是形状上都发生了较大的改变，下面以iPhone 8作为参照物，看看到底iPhone X的适配我们要怎么考虑。</p>
<p>我们看看iPhone X尺寸上的变化：</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205127200-216760608.png" alt="img"></p>
<h4 id="28-2-iPhoneX的适配—安全区域-safe-area"><a href="#28-2-iPhoneX的适配—安全区域-safe-area" class="headerlink" title="28.2 iPhoneX的适配—安全区域(safe area)"></a>28.2 iPhoneX的适配—安全区域(safe area)</h4><p>苹果对于 iPhone X 的设计布局意见如下：</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205159528-291294353.png" alt="img"></p>
<p>核心内容应该处于 Safe area 确保不会被设备圆角(corners)，传感器外壳(sensor housing，齐刘海) 以及底部的 Home Indicator 遮挡。也就是说 我们设计显示的内容应该尽可能的在安全区域内；</p>
<h4 id="28-3-iPhoneX的适配—适配方案viewport-fit"><a href="#28-3-iPhoneX的适配—适配方案viewport-fit" class="headerlink" title="28.3 iPhoneX的适配—适配方案viewport-fit"></a>28.3 iPhoneX的适配—适配方案viewport-fit</h4><h5 id="28-3-1-PhoneX的适配，在iOS-11中采用了viewport-fit的meta标签作为适配方案；viewport-fit的默认值是auto。"><a href="#28-3-1-PhoneX的适配，在iOS-11中采用了viewport-fit的meta标签作为适配方案；viewport-fit的默认值是auto。" class="headerlink" title="28.3.1 PhoneX的适配，在iOS 11中采用了viewport-fit的meta标签作为适配方案；viewport-fit的默认值是auto。"></a>28.3.1 PhoneX的适配，在iOS 11中采用了viewport-fit的meta标签作为适配方案；viewport-fit的默认值是auto。</h5><p>　　 viewport-fit取值如下：</p>
<table>
<thead>
<tr>
<th>auto</th>
<th>默认：viewprot-fit:contain;页面内容显示在safe area内</th>
</tr>
</thead>
<tbody><tr>
<td>cover</td>
<td>viewport-fit:cover,页面内容充满屏幕</td>
</tr>
</tbody></table>
<p>　　  viewport-fit meta标签设置(cover时) </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width,initial-scale&#x3D;1.0, minimum-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;no, viewport-fit&#x3D;cover&quot;&gt;</span><br></pre></td></tr></table></figure>

<h5 id="28-3-2-css-constant-函数-与safe-area-inset-top-amp-safe-area-inset-left-amp-safe-area-inset-right-amp-safe-area-inset-bottom的介绍"><a href="#28-3-2-css-constant-函数-与safe-area-inset-top-amp-safe-area-inset-left-amp-safe-area-inset-right-amp-safe-area-inset-bottom的介绍" class="headerlink" title="28.3.2 css constant()函数 与safe-area-inset-top &amp; safe-area-inset-left &amp; safe-area-inset-right &amp; safe-area-inset-bottom的介绍"></a>28.3.2 css constant()函数 与safe-area-inset-top &amp; safe-area-inset-left &amp; safe-area-inset-right &amp; safe-area-inset-bottom的介绍</h5><p> <img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205332075-1346398687.png" alt="img"></p>
<p>​        如上图所示 在iOS 11中的WebKit包含了一个新的CSS函数constant()，以及一组四个预定义的常量：safe-area-inset-left, safe-area-inset-right, safe-area-inset-top和 safe-area-inset-bottom。当合并一起使用时，允许样式引用每个方面的安全区域的大小。</p>
<p>​        当我们设置viewport-fit:contain,也就是默认的时候时;设置safe-area-inset-left, safe-area-inset-right, safe-area-inset-top和 safe-area-inset-bottom等参数时不起作用的。</p>
<p>​        当我们设置viewport-fit:cover时：设置如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    padding-top: constant(safe-area-inset-top);   &#x2F;&#x2F;为导航栏+状态栏的高度 88px            </span><br><span class="line">    padding-left: constant(safe-area-inset-left);   &#x2F;&#x2F;如果未竖屏时为0                </span><br><span class="line">    padding-right: constant(safe-area-inset-right); &#x2F;&#x2F;如果未竖屏时为0                </span><br><span class="line">    padding-bottom: constant(safe-area-inset-bottom);&#x2F;&#x2F;为底下圆弧的高度 34px       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="28-4-iPhoneX的适配—高度统计"><a href="#28-4-iPhoneX的适配—高度统计" class="headerlink" title="28.4 iPhoneX的适配—高度统计"></a>28.4 iPhoneX的适配—高度统计</h4><p>  viewport-fit:cover + 导航栏</p>
<p>　　<img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205642513-1610316669.png" alt="img"></p>
<h4 id="28-5-iPhoneX的适配—媒体查询"><a href="#28-5-iPhoneX的适配—媒体查询" class="headerlink" title="28.5 iPhoneX的适配—媒体查询"></a>28.5 iPhoneX的适配—媒体查询</h4><p>注意这里采用的是690px(safe area高度)，不是812px;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@media only screen and (width: 375px) and (height: 690px)&#123;  body &#123;    background: blue;  &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="28-6-iphoneX-viewport-fit-问题总结"><a href="#28-6-iphoneX-viewport-fit-问题总结" class="headerlink" title="28.6 iphoneX viewport-fit  问题总结"></a>28.6 iphoneX viewport-fit  问题总结</h4><h5 id="28-6-1-关于iphoneX-页面使用了渐变色时；如果viewport-fit-cover"><a href="#28-6-1-关于iphoneX-页面使用了渐变色时；如果viewport-fit-cover" class="headerlink" title="28.6.1 关于iphoneX 页面使用了渐变色时；如果viewport-fit:cover;"></a>28.6.1 关于iphoneX 页面使用了渐变色时；如果viewport-fit:cover;</h5><p>​        在设置了背景色单色和渐变色的区别，如果是单色时会填充整个屏幕，如果设置了渐变色 那么只会更加子元素的高度去渲染；而且页面的高度只有690px高度，上面使用了padding-top:88px;</p>
<p>　　<img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205730528-339953907.png" alt="img"></p>
<p>body固定为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;&lt;div class&#x3D;&quot;content&quot;&gt;this is subElementdiv&gt;body&gt;</span><br></pre></td></tr></table></figure>

<p>1.单色时：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    padding: 0;</span><br><span class="line">    margin: 0;        </span><br><span class="line">&#125;        </span><br><span class="line">body &#123;</span><br><span class="line">    background:green;</span><br><span class="line">    padding-top: constant(safe-area-inset-top); &#x2F;&#x2F;88px            </span><br><span class="line">    &#x2F;*padding-left: constant(safe-area-inset-left);*&#x2F;            </span><br><span class="line">    &#x2F;*padding-right: constant(safe-area-inset-right);*&#x2F;            </span><br><span class="line">    &#x2F;*padding-bottom: constant(safe-area-inset-bottom);*&#x2F;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.渐变色</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    padding: 0;</span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">body &#123;</span><br><span class="line">    background:-webkit-gradient(linear, 0 0, 0 bottom, from(#ffd54f), to(#ffaa22));</span><br><span class="line">    padding-top: constant(safe-area-inset-top); &#x2F;&#x2F;88px</span><br><span class="line">    &#x2F;*padding-left: constant(safe-area-inset-left);*&#x2F;</span><br><span class="line">    &#x2F;*padding-right: constant(safe-area-inset-right);*&#x2F;</span><br><span class="line">    &#x2F;*padding-bottom: constant(safe-area-inset-bottom);*&#x2F;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解决使用渐变色 仍旧填充整个屏幕的方法；CSS设置如下</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106205929419-463639658.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;initial-scale&#x3D;1, viewport-fit&#x3D;cover&quot;&gt;</span><br><span class="line">   &lt;title&gt;Designing Websites for iPhone X: Respecting the safe areas&lt;&#x2F;title&gt;</span><br><span class="line">   &lt;style&gt;        </span><br><span class="line">   * &#123;</span><br><span class="line">       padding: 0;</span><br><span class="line">       margin: 0;</span><br><span class="line">   &#125;</span><br><span class="line">   html, body &#123;</span><br><span class="line">       height: 100%;</span><br><span class="line">   &#125;</span><br><span class="line">   body &#123;</span><br><span class="line">       padding-top: constant(safe-area-inset-top);</span><br><span class="line">       padding-left: constant(safe-area-inset-left);</span><br><span class="line">       padding-right: constant(safe-area-inset-right);</span><br><span class="line">       padding-bottom: constant(safe-area-inset-bottom);</span><br><span class="line">   &#125;</span><br><span class="line">   .content &#123;</span><br><span class="line">       background: -webkit-gradient(linear, 0 0, 0 bottom, from(#ffd54f), to(#ffaa22));</span><br><span class="line">       width: 100%;</span><br><span class="line">       height: 724px;</span><br><span class="line">   &#125;    &lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;content&quot;&gt;this is subElement&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h5 id="28-6-2-页面元素使用了固定定位的适配即：-position-fixed"><a href="#28-6-2-页面元素使用了固定定位的适配即：-position-fixed" class="headerlink" title="28.6.2 页面元素使用了固定定位的适配即：{position:fixed;}"></a>28.6.2 页面元素使用了固定定位的适配即：{position:fixed;}</h5><p>​    1）子元素页面固定在底部时；使用viewport-fit:contain时;可以看到bottom:0时只会显示在安全区域内；</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210027731-2046065048.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">   &lt;!--&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;initial-scale&#x3D;1, viewport-fit&#x3D;cover&quot;&gt;--&gt;</span><br><span class="line">   &lt;title&gt;Designing Websites for iPhone X: Respecting the safe areas&lt;&#x2F;title&gt;</span><br><span class="line">   &lt;style&gt;</span><br><span class="line">       * &#123;</span><br><span class="line">           padding: 0;</span><br><span class="line">           margin: 0;</span><br><span class="line">       &#125;</span><br><span class="line">       &#x2F;*html,body &#123;*&#x2F;</span><br><span class="line">           &#x2F;*height: 100%;*&#x2F;</span><br><span class="line">       &#x2F;*&#125;*&#x2F;</span><br><span class="line">       body &#123;</span><br><span class="line">           background: grey;</span><br><span class="line">           &#x2F;*padding-top: constant(safe-area-inset-top);*&#x2F;</span><br><span class="line">           &#x2F;*padding-left: constant(safe-area-inset-left);*&#x2F;</span><br><span class="line">           &#x2F;*padding-right: constant(safe-area-inset-right);*&#x2F;</span><br><span class="line">           &#x2F;*padding-bottom: constant(safe-area-inset-bottom);*&#x2F;</span><br><span class="line">       &#125;</span><br><span class="line">       .top &#123;</span><br><span class="line">           width: 100%;</span><br><span class="line">           height: 44px;</span><br><span class="line">           background: purple;</span><br><span class="line">       &#125;</span><br><span class="line">       .bottom &#123;</span><br><span class="line">           position: fixed;</span><br><span class="line">           bottom: 0;</span><br><span class="line">           left: 0;</span><br><span class="line">           right: 0;</span><br><span class="line">           height: 44px;</span><br><span class="line">           color: black;</span><br><span class="line">           background: green;</span><br><span class="line">       &#125;</span><br><span class="line">   &lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;div class&#x3D;&quot;top&quot;&gt;this is top&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;div class&#x3D;&quot;bottom&quot;&gt;this is bottom&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>2） 子元素页面固定在底部时；使用viewport-fit:cover时;可以看到bottom:0时只会显示在安全区域内；</p>
<p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210117559-254939495.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* &#123;  </span><br><span class="line">    padding: 0;  </span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*html,body &#123;*&#x2F;  </span><br><span class="line">	&#x2F;*height: 100%;*&#x2F;</span><br><span class="line">&#x2F;*&#125;*&#x2F;</span><br><span class="line">body &#123;  </span><br><span class="line">    background: grey;  </span><br><span class="line">    padding-top: constant(safe-area-inset-top);  </span><br><span class="line">    &#x2F;*padding-left: constant(safe-area-inset-left);*&#x2F;  </span><br><span class="line">    &#x2F;*padding-right: constant(safe-area-inset-right);*&#x2F;  </span><br><span class="line">    &#x2F;*padding-bottom: constant(safe-area-inset-bottom);*&#x2F;</span><br><span class="line">&#125;</span><br><span class="line">.top &#123;  </span><br><span class="line">    width: 100%;  </span><br><span class="line">    height: 44px;  </span><br><span class="line">    background: purple;</span><br><span class="line">&#125;</span><br><span class="line">.bottom &#123;  </span><br><span class="line">    position: fixed;  </span><br><span class="line">    bottom: 0;  </span><br><span class="line">    left: 0;  </span><br><span class="line">    right: 0;  </span><br><span class="line">    height: 44px;  </span><br><span class="line">    color: black;  </span><br><span class="line">    background: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 添加html,body  {width:100%;heigth:100%}</p>
<p> <img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210233528-2079516846.png" alt="img"></p>
<p> 图1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">          padding: 0;</span><br><span class="line">          margin: 0;</span><br><span class="line">      &#125;</span><br><span class="line">      html,body &#123;</span><br><span class="line">          height: 100%;</span><br><span class="line">      &#125;</span><br><span class="line">      body &#123;</span><br><span class="line">          background: grey;</span><br><span class="line">          padding-top: constant(safe-area-inset-top);</span><br><span class="line">          padding-left: constant(safe-area-inset-left);</span><br><span class="line">          padding-right: constant(safe-area-inset-right);</span><br><span class="line">          padding-bottom: constant(safe-area-inset-bottom);</span><br><span class="line">      &#125;</span><br><span class="line">      .top &#123;</span><br><span class="line">          width: 100%;</span><br><span class="line">          height: 44px;</span><br><span class="line">          background: purple;</span><br><span class="line">      &#125;</span><br><span class="line">      .bottom &#123;</span><br><span class="line">          position: fixed;</span><br><span class="line">          bottom: 0;</span><br><span class="line">          left: 0;</span><br><span class="line">          right: 0;</span><br><span class="line">          height: 44px;</span><br><span class="line">          color: black;</span><br><span class="line">          background: green;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>图2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    padding: 0;</span><br><span class="line">    margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">html,body &#123;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">body &#123;</span><br><span class="line">    background: grey;</span><br><span class="line">    padding-top: constant(safe-area-inset-top);</span><br><span class="line">    padding-left: constant(safe-area-inset-left);</span><br><span class="line">    padding-right: constant(safe-area-inset-right);</span><br><span class="line">    &#x2F;*padding-bottom: constant(safe-area-inset-bottom);*&#x2F;</span><br><span class="line">&#125;</span><br><span class="line">.top &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 44px;</span><br><span class="line">    background: purple;</span><br><span class="line">&#125;</span><br><span class="line">.bottom &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    height: 44px;</span><br><span class="line">    color: black;</span><br><span class="line">    background: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="28-6-3-关于alertView弹框-遮罩层的解决方案"><a href="#28-6-3-关于alertView弹框-遮罩层的解决方案" class="headerlink" title="28.6.3 关于alertView弹框 遮罩层的解决方案"></a>28.6.3 关于alertView弹框 遮罩层的解决方案</h5><p><img src="https://images2017.cnblogs.com/blog/949019/201711/949019-20171106210345513-1798455572.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">   &lt;!--&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, minimum-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;no&quot;&gt;--&gt;</span><br><span class="line">   &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width,initial-scale&#x3D;1.0, minimum-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;no, viewport-fit&#x3D;cover&quot;&gt;</span><br><span class="line">   &lt;meta http-equiv&#x3D;&quot;pragma&quot; content&#x3D;&quot;no-cache&quot;&gt;</span><br><span class="line">   &lt;meta http-equiv&#x3D;&quot;cache-control&quot; content&#x3D;&quot;no-cache&quot;&gt;</span><br><span class="line">   &lt;meta http-equiv&#x3D;&quot;expires&quot; content&#x3D;&quot;0&quot;&gt;</span><br><span class="line">   &lt;title&gt;alertView&lt;&#x2F;title&gt;</span><br><span class="line">   &lt;script data-res&#x3D;&quot;eebbk&quot;&gt;</span><br><span class="line">       document.documentElement.style.fontSize &#x3D; window.screen.width &#x2F; 7.5 + &#39;px&#39;;</span><br><span class="line">   &lt;&#x2F;script&gt;</span><br><span class="line">   &lt;style&gt;</span><br><span class="line">       * &#123;</span><br><span class="line">           margin: 0;</span><br><span class="line">           padding: 0;</span><br><span class="line">       &#125;</span><br><span class="line">       html,body &#123;</span><br><span class="line">           width: 100%;</span><br><span class="line">           height: 100%;</span><br><span class="line">       &#125;</span><br><span class="line">       body &#123;</span><br><span class="line">           font-size: 0.32rem;</span><br><span class="line">           padding-top: constant(safe-area-inset-top);</span><br><span class="line">           padding-left: constant(safe-area-inset-left);</span><br><span class="line">           padding-right: constant(safe-area-inset-right);</span><br><span class="line">           padding-bottom: constant(safe-area-inset-bottom);</span><br><span class="line">       &#125;</span><br><span class="line">       .content &#123;</span><br><span class="line">           text-align: center;</span><br><span class="line">       &#125;</span><br><span class="line">       .testBut &#123;</span><br><span class="line">           margin: 50px auto;</span><br><span class="line">           width: 100px;</span><br><span class="line">           height: 44px;</span><br><span class="line">           border: 1px solid darkgray;</span><br><span class="line">           outline:none;</span><br><span class="line">           user-select: none;</span><br><span class="line">           background-color: yellow;</span><br><span class="line">       &#125;</span><br><span class="line">   &lt;&#x2F;style&gt;</span><br><span class="line">   &lt;link href&#x3D;&quot;alertView.css&quot; rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;section class&#x3D;&quot;content&quot;&gt;</span><br><span class="line">       &lt;button class&#x3D;&quot;testBut&quot; οnclick&#x3D;&quot;showLoading()&quot;&gt;弹框加载&lt;&#x2F;button&gt;</span><br><span class="line">   &lt;&#x2F;section&gt;</span><br><span class="line">   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;alertView.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">       function showLoading() &#123;</span><br><span class="line">           UIAlertView.show(&#123;</span><br><span class="line">               type:&quot;input&quot;,</span><br><span class="line">               title:&quot;温馨提示&quot;,              &#x2F;&#x2F;标题</span><br><span class="line">               content:&quot;VIP会员即将到期&quot;,     &#x2F;&#x2F;获取新的</span><br><span class="line">               isKnow:false</span><br><span class="line">           &#125;);</span><br><span class="line">           var xx &#x3D; new UIAlertView();</span><br><span class="line">          console.log(xx);</span><br><span class="line">       &#125;</span><br><span class="line">   &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="30-微信小程序自定义导航栏（适配刘海屏）"><a href="#30-微信小程序自定义导航栏（适配刘海屏）" class="headerlink" title="30.微信小程序自定义导航栏（适配刘海屏）"></a>30.微信小程序自定义导航栏（适配刘海屏）</h3><h4 id="30-1-原生开发处理"><a href="#30-1-原生开发处理" class="headerlink" title="30.1 原生开发处理"></a>30.1 原生开发处理</h4><p><img src="https://img-blog.csdnimg.cn/20190404174408525.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5MTA2ODU0,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>1）首先在根据官方文档，我们在小程序修改 app.json 中的 window 的属性 “navigationStyle”: “custom”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pages&quot;:[</span><br><span class="line">    &quot;pages&#x2F;index&#x2F;index&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;window&quot;:&#123;</span><br><span class="line">    &quot;navigationBarBackgroundColor&quot;: &quot;#fff&quot;,</span><br><span class="line">    &quot;navigationBarTextStyle&quot;:&quot;black&quot;,</span><br><span class="line">    &quot;navigationStyle&quot;: &quot;custom&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2）通过微信小程序API，wx.getSystemInfo获取设备状态栏高度，wx.getMenuButtonBoundingClientRect()获取菜单按钮（右上角胶囊按钮）的布局位置信息。坐标信息以屏幕左上角为原点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    wx.getSystemInfo(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.globalData.statusBar = e.statusBarHeight; <span class="comment">//状态栏高度</span></span><br><span class="line">        <span class="keyword">let</span> custom = wx.getMenuButtonBoundingClientRect();<span class="comment">//菜单按钮</span></span><br><span class="line">        <span class="keyword">this</span>.globalData.custom = custom;</span><br><span class="line">        <span class="keyword">this</span>.globalData.customBar = custom.bottom + custom.top - e.statusBarHeight;</span><br><span class="line">        <span class="comment">//计算得到定义的状态栏高度</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  globalData: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//以iPhoneX为例 拿到的数据为 (获取到的数据单位统一为px)</span></span><br><span class="line"><span class="comment">// globalData: &#123;</span></span><br><span class="line"><span class="comment">//   custom: &#123;</span></span><br><span class="line"><span class="comment">//     bottom: 82</span></span><br><span class="line"><span class="comment">//     height: 32</span></span><br><span class="line"><span class="comment">//     left: 278</span></span><br><span class="line"><span class="comment">//     right: 365</span></span><br><span class="line"><span class="comment">//     top: 50</span></span><br><span class="line"><span class="comment">//     width: 87</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   customBar: 88</span></span><br><span class="line"><span class="comment">//   statusBar: 44</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<p>3）自定义栏的配置和需要拿到的相关数据都拿到了，接下来就去写导航栏的样式。( 注：自定义导航栏不存在原生的返回按钮，所以返回按钮需要我们自己写出来并添加返回事件)</p>
<p>样式问题通过css实现的方式有很多，如下所示：</p>
<p><img src="https://img-blog.csdnimg.cn/20190408102625303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5MTA2ODU0,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>wxml：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'nav'</span> <span class="attr">style</span>=<span class="string">"height:&#123;&#123;customBar&#125;&#125;px"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'con'</span> <span class="attr">style</span>=<span class="string">"height:&#123;&#123;customBar&#125;&#125;px;padding-top:&#123;&#123;statusBar&#125;&#125;px;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"backBtn"</span> <span class="attr">bindtap</span>=<span class="string">"goBack"</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">"iconfont icon-fanhui"</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title"</span> <span class="attr">style</span>=<span class="string">"top:&#123;&#123;statusBar&#125;&#125;px"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>wxss：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">view</span>, <span class="selector-tag">scroll-view</span>, <span class="selector-tag">swiper</span>, <span class="selector-tag">button</span>, <span class="selector-tag">input</span>, <span class="selector-tag">textarea</span>, <span class="selector-tag">label</span>, <span class="selector-tag">navigator</span>, <span class="selector-tag">image</span> &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.nav</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">38</span>, <span class="number">185</span>, <span class="number">243</span>);</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">340</span>rpx);</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.backBtn</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">30</span>rpx;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>js：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = getApp();</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    statusBar: app.globalData.statusBar,</span><br><span class="line">    customBar: app.globalData.customBar,</span><br><span class="line">    custom: app.globalData.custom</span><br><span class="line">  &#125;,</span><br><span class="line">  goBack()&#123;</span><br><span class="line">    wx.navigateBack(&#123;</span><br><span class="line">      delta: <span class="number">1</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="30-2-mpVue开发处理"><a href="#30-2-mpVue开发处理" class="headerlink" title="30.2 mpVue开发处理"></a>30.2 mpVue开发处理</h4><p>​        设计稿的1px在手机中是怎样显示出来的，首先看下图：</p>
<p><img src="https://img-blog.csdnimg.cn/20190103143547778." alt=""></p>
<p>​        从上图得知了各个安卓和IOS常规屏幕的宽高以及像素比，在日常设计稿常以iPhone6 750px(375 * 2 = 750) 为标准设计，从以上信息得知我们设计稿中的1px 在iPhone6中是占据了2px。</p>
<p>​    下面将以10px为单位在每一个型号进行单位换算</p>
<table>
<thead>
<tr>
<th>型号</th>
<th>宽度</th>
<th>高度</th>
<th>设计稿单位（宽度）</th>
<th>像素比</th>
<th>转换单位(10px)</th>
</tr>
</thead>
<tbody><tr>
<td>iPhone5</td>
<td>320</td>
<td>568</td>
<td>640</td>
<td>2</td>
<td>20</td>
</tr>
<tr>
<td>iPhone6</td>
<td>375</td>
<td>667</td>
<td>750</td>
<td>2</td>
<td>20</td>
</tr>
<tr>
<td>iPhone6 Plus</td>
<td>414</td>
<td>736</td>
<td>1242</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>iPhone7</td>
<td>375</td>
<td>667</td>
<td>750</td>
<td>2</td>
<td>20</td>
</tr>
<tr>
<td>iPhone7 Plus</td>
<td>414</td>
<td>736</td>
<td>1242</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>iPhone X</td>
<td>375</td>
<td>812</td>
<td>1125</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>Nexus 5</td>
<td>360</td>
<td>640</td>
<td>1080</td>
<td>3</td>
<td>30</td>
</tr>
<tr>
<td>Nexus 5x</td>
<td>411</td>
<td>731</td>
<td>1078.875</td>
<td>2.625</td>
<td>26.25</td>
</tr>
<tr>
<td>Nexus 6</td>
<td>412</td>
<td>732</td>
<td>1536</td>
<td>3.5</td>
<td>35</td>
</tr>
</tbody></table>
<p>​        从上表发现了一个规律 以iPhone6与iPhone6 Plus 为例 转换单位是由 像素比 * 转换单位 得出 由此推算得出单位转换公式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">（像素比 * 转换单位）&#x2F; 像素比</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（2 * 10）&#x2F; 2 &#x3D; 10&#x2F;&#x2F;iPhone6</span><br><span class="line">（3 * 10）&#x2F; 3 &#x3D; 10&#x2F;&#x2F;iPhone6 Plus</span><br></pre></td></tr></table></figure>

<p>​        那么得到了需要转换的单位后怎么进行适配呢，首先要得到系统状态栏高度，利用小程序API wx.getSystemInfo(Object object)中的statusBarHeight得到了系统状态栏高度（解决万恶的刘海屏，水滴屏问题）。</p>
<p>​        <strong>实施步骤：</strong></p>
<p>1）在src-&gt;main.js中添加如下代码：</p>
<p><img src="08.png" alt=""></p>
<p>2）在需要设置刘海屏的页面中添加如下代码，下面以home页面为例说明。</p>
<p>a.布局代码：</p>
<p><img src="09.png" alt=""></p>
<p>b.逻辑处理：</p>
<p><img src="10.png" alt=""></p>
<p>完整代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;home&quot; :style&#x3D;&quot;&#123;height: windowHeight+&#39;px&#39;&#125;&quot;&gt;</span><br><span class="line">    &lt;header class&#x3D;&quot;headNav&quot; :style&#x3D;&quot;&#123; paddingTop: statusBarHeight + &#39;px&#39;, height: navHeight + &#39;px&#39; &#125;&quot;&gt;</span><br><span class="line">      &lt;section class&#x3D;&quot;headArea&quot; :style&#x3D;&quot;&#123; height: headAreaHeight + &#39;px&#39;, marginTop: headAreaMarTop + &#39;px&#39; &#125;&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&#39;logo&#39;&gt;</span><br><span class="line">          &lt;img src&#x3D;&quot;https:&#x2F;&#x2F;www.hspstudio.club&#x2F;images&#x2F;home&#x2F;logo.png&quot; &#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div class&#x3D;&#39;search&#39; :style&#x3D;&quot;&#123; width: headRightBoxW + &#39;px&#39; &#125;&quot;&gt;标题&lt;&#x2F;div&gt;</span><br><span class="line">      &lt;&#x2F;section&gt;</span><br><span class="line">    &lt;&#x2F;header&gt;</span><br><span class="line">    </span><br><span class="line">	&lt;!-- 引入轮播图组件 --&gt;</span><br><span class="line">    &lt;banner :swiperList&#x3D;&quot;swiperList&quot;&#x2F;&gt;    </span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  import Banner from &#39;..&#x2F;..&#x2F;components&#x2F;banner&#39;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        pixelRatio: this.globalData.phoneInfo.pixelRatio, &#x2F;&#x2F;系统像素比</span><br><span class="line">        statusBarHeight: this.globalData.phoneInfo.statusBarHeight, &#x2F;&#x2F;系统状态栏高度</span><br><span class="line">        navHeight: &quot;&quot;, &#x2F;&#x2F;顶部导航栏高度</span><br><span class="line">        headAreaHeight:this.globalData.phoneInfo.pixelRatio * 35 &#x2F; this.globalData.phoneInfo.pixelRatio, &#x2F;&#x2F;顶部内容区域高度</span><br><span class="line">        headAreaMarTop: &quot;&quot;, &#x2F;&#x2F;顶部内容区域外边距</span><br><span class="line">        headleftBoxW: &quot;&quot;, &#x2F;&#x2F;顶部内容左侧区域外边距</span><br><span class="line">        headRightBoxW: &quot;&quot;, &#x2F;&#x2F;顶部内容右侧区域外边距</span><br><span class="line">        containersHeight: &quot;&quot;, &#x2F;&#x2F;页面内容区域高度</span><br><span class="line">        windowHeight: this.globalData.phoneInfo.windowHeight,</span><br><span class="line">        swiperList: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted () &#123;</span><br><span class="line">      &#x2F;&#x2F;IOS 与 安卓进行差异化处理</span><br><span class="line">      if (this.globalData.phoneInfo.system.substring(0, 3) &#x3D;&#x3D; &quot;iOS&quot;) &#123;</span><br><span class="line">        this.navHeight &#x3D; this.pixelRatio * 40 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headAreaMarTop &#x3D; this.pixelRatio * 0.5 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headleftBoxW &#x3D; this.globalData.phoneInfo.windowWidth - this.pixelRatio * 100 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headRightBoxW &#x3D; this.pixelRatio * 100 &#x2F; this.pixelRatio;</span><br><span class="line">        this.containersHeight &#x3D; this.globalData.phoneInfo.windowHeight - (this.statusBarHeight + this.pixelRatio * 40 &#x2F; this.pixelRatio);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.navHeight &#x3D; this.pixelRatio * 45 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headAreaMarTop &#x3D; this.pixelRatio * 2.5 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headleftBoxW &#x3D;  this.globalData.phoneInfo.windowWidth - this.pixelRatio * 110 &#x2F; this.pixelRatio;</span><br><span class="line">        this.headRightBoxW &#x3D; this.pixelRatio * 110 &#x2F; this.pixelRatio;</span><br><span class="line">        this.containersHeight &#x3D; this.globalData.phoneInfo.windowHeight -  (this.statusBarHeight + this.pixelRatio * 45 &#x2F; this.pixelRatio);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line">      var that &#x3D; this;</span><br><span class="line">      console.log(this.globalData.phoneInfo)</span><br><span class="line">      wx.request(&#123;</span><br><span class="line">        url: &#39;https:&#x2F;&#x2F;www.hspstudio.club&#x2F;swiper&#39;,</span><br><span class="line">        success(res)&#123;</span><br><span class="line">          &#x2F;&#x2F;console.log(res.data.data);</span><br><span class="line">          that.swiperList &#x3D; res.data.data;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      Banner</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .home &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    background: #735041 url(&#39;https:&#x2F;&#x2F;www.hspstudio.club&#x2F;images&#x2F;bg.png&#39;) repeat-y;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  .headNav &#123;</span><br><span class="line">    background-color: #591614;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line">  .headArea &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">  &#125;</span><br><span class="line">  .logo &#123;</span><br><span class="line">    padding: 0 15px;</span><br><span class="line">    float: left;</span><br><span class="line">  &#125;</span><br><span class="line">  .logo img &#123;</span><br><span class="line">    width: 72px;</span><br><span class="line">    height: 15px;</span><br><span class="line">  &#125;</span><br><span class="line">  .search &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://harrison258.github.io/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/" data-id="ck6zewsp30004s8ib68qgewit" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/02/24/Yogo%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%EF%BC%88PC%E7%AB%AF%E7%94%B5%E5%95%86%E7%BD%91%E7%AB%99%EF%BC%89/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Yogo项目开发（PC端电商网站）
        
      </div>
    </a>
  
  
    <a href="/2020/02/24/%5B%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%5D%E5%9C%A8%E7%BA%BF%E5%BD%B1%E8%AF%84/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">[小程序原生开发]在线影评</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/24/%E4%BA%91%E8%B0%B7%E6%97%85%E6%B8%B8(Vue+Node.js+Stylus)%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91/">云谷旅游(Vue+Node.js+Stylus)项目开发</a>
          </li>
        
          <li>
            <a href="/2020/02/24/Yogo%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%EF%BC%88PC%E7%AB%AF%E7%94%B5%E5%95%86%E7%BD%91%E7%AB%99%EF%BC%89/">Yogo项目开发（PC端电商网站）</a>
          </li>
        
          <li>
            <a href="/2020/02/24/%E9%94%A6%E6%9B%BC%E5%95%86%E5%9F%8E%EF%BC%88mpvue+WeUI+MySQL+Node.js%EF%BC%89/">锦曼商城（mpvue+WeUI+MySQL+Node.js）</a>
          </li>
        
          <li>
            <a href="/2020/02/24/%5B%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%5D%E5%9C%A8%E7%BA%BF%E5%BD%B1%E8%AF%84/">[小程序原生开发]在线影评</a>
          </li>
        
          <li>
            <a href="/2020/02/24/%E7%82%B9%E9%A4%90APP%E5%BC%80%E5%8F%91%EF%BC%88Vue+ES6+Vuex+Axios%EF%BC%89/">点餐APP开发（Vue+ES6+Vuex+Axios）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 - 2020 版权归侯仕平所有，并提供技术支持！未经授权，不得商用！<br>
      微信公众号： <a href="###" target="_blank">web前端开发</a>
      个人网站： <a href="http://www.hspstudio.club" target="_blank">http(s)://www.hspstudio.club</a>（说明：如果网站打不开，可能该网站在用于其它测试）
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">全部条目</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>